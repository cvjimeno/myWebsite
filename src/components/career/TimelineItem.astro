---
// src/components/career/TimelineItem.astro
import { Image } from 'astro:assets';

export interface Props {
  logoSrc: any;
  logoAlt: string;
  role: string;
  institutionName: string;
  institutionColorClass?: string;
  dates: string;
  descriptionLines: string[];
  ctaLink?: string;
  ctaText?: string;
  isLastItem?: boolean; // New prop to handle the line for the last item
}

const {
  logoSrc: logo,
  logoAlt,
  role,
  institutionName,
  institutionColorClass = 'text-text-primary',
  dates,
  descriptionLines,
  ctaLink,
  ctaText,
  isLastItem = false, // Default to false
} = Astro.props;

const hasCta = ctaLink && ctaText;
---

<li class="flex gap-x-4 sm:gap-x-6 vrelative"> {/* Added `relative` and adjusted gap */}
  
  <!-- Vertical Line & Logo Column -->
  <div class="flex flex-col items-center w-16 md:w-20 flex-shrink-0 pb-4"> {/* Container for logo and line */}
    <div class="w-16 h-16 md:w-20 md:h-20 flex-shrink-0 flex items-center justify-center self-start pb-1"> {/* Centered logo within its space */}
      {logo && (
        <Image
          src={logo}
          alt={logoAlt}
          width={80}
          height={80}
          format="webp"
          class="object-contain max-w-full  max-h-[80%] rounded-sm"
        />
      )}
    </div>
        {!isLastItem && (
      <div class="mt-[2px] h-full w-0.5 bg-gray-300 text-text-secondary"></div> 
    )}
  </div>

  <!-- Content Column -->
  <div class="flex-grow pt-1 pb-8"> 
    <h3 class="text-xl md:text-2xl font-semibold text-text-primary mb-1">
      {role}
      {institutionName && (
        <span class="font-semibold">
          {' en '}
          <span class:list={[institutionColorClass, 'font-bold']}>
            {institutionName}
          </span>
        </span>
      )}
    </h3>
    <p class="text-sm text-text-secondary mb-3">{dates}</p>

    <div class="prose prose-sm sm:prose-base text-text-secondary max-w-none space-y-3">
      {descriptionLines.map(line => (
        <p>{line}</p>
      ))}
    </div>

    {hasCta && (
      <div class="mt-4">
        <a
          href={ctaLink}
          class="inline-block px-5 py-2.5 bg-accent-blue text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors"
        >
          {ctaText}
        </a>
      </div>
    )}
  </div>
</li>